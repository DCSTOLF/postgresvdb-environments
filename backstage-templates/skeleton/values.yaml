environment: ${{ values.environmentName }}

vdb:
  name: "${{ values.environmentName }}-vdb"
  database:
    name: "${{ values.databaseName }}"
    user: "${{ values.databaseUser }}"
    password: "${{ values.databasePassword }}"
  resources:
    requests:
      memory: "${{ values.memoryRequest }}"
      cpu: "${{ values.cpuRequest }}"
    limits:
      memory: "${{ values.memoryLimit }}"
      cpu: "${{ values.cpuLimit }}"
  
  # PostgreSQL configuration
  postgresConfig:
    - name: "listen_addresses"
      value: "'*'"
{%- for param in values.postgresConfig %}
    - name: "${{ param.name }}"
      value: "${{ param.value }}"
{%- endfor %}

# Monitoring configuration
monitoring:
  enabled: ${{ values.enableMonitoring }}
  {% if values.enableMonitoring %}
  serviceMonitor:
    enabled: true
  {% endif %}

# Service configuration
service:
  public: ${{ values.enablePublicAccess }}
  {% if values.enablePublicAccess %}
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
  {% endif %}
  labels:
    environment: "${{ values.environmentName }}"
    type: "${{ values.environmentType }}"
